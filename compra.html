<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="js/popper.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
        integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

    <link rel="stylesheet" href="css/sweetalert2.min.css">

    <title>Tú Jardín</title>
  </head>
  <body>
    
    <nav class="navbar navbar-light" style="background-color: #B4E197;">
        <ul class="nav mr-auto">
            <a class="navbar-brand" href="index.html">
                <img src="imagenes/logo.png" width="30" height="30" alt="">
            </a>
            <li class="nav-item">
                <a style = "color: black" class="nav-link active" aria-current="page" href="index.html">
                    <img src="imagenes/home.png" width="30" height="30">
                </a>
            </li>
    </nav>

    <main>
        <div class="container">
            <div class="row mt-3">
                <div class="col">
                    <h2 class="d-flex justify-content-center mb-3">Realizar Compra</h2>
                    <form id="procesar-pago" action="#" method="post">
                        <div class="form-group row justify-content-center">
                            <label for="rut" class="col-3 col-md-1 col-form-label h2">RUT</label>
                            <div class="col-3 col-md-3">
                                <input type="number" class="form-control" id="inputRut"
                                    placeholder="Ingresa RUT" name="destinatario">
                            </div>
                            <label for="dv" class="col-3 col-md-1 col-form-label h2">DV</label>
                            <div class="col-3 col-md-3">
                                <input type="text" class="form-control" id="inputDv"
                                    placeholder="Ingresa DV" name="dv">
                            </div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <label for="primerNombre" class="col-3 col-md-1 col-form-label h2">Primer Nombre</label>
                            <div class="col-3 col-md-3">
                                <input type="text" class="form-control" id="inputPrimerNombre"
                                    placeholder="Ingresa primer nombre" name="primerNombre">
                            </div>
                            <label for="segundoNombre" class="col-3 col-md-1 col-form-label h2">Segundo Nombre</label>
                            <div class="col-3 col-md-3">
                                <input type="text" class="form-control" id="inputSegundoNombre"
                                    placeholder="Ingresa segundo nombre" name="segundoNombre">
                            </div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <label for="PrimerApelldio" class="col-3 col-md-1 col-form-label h2">Primer Apellido</label>
                            <div class="col-3 col-md-3">
                                <input type="text" class="form-control" id="inputPrimerApellido"
                                    placeholder="Ingresa primer apellido" name="PrimerApellido">
                            </div>
                            <label for="SegundoApelldio" class="col-3 col-md-1 col-form-label h2">Segundo Apellido</label>
                            <div class="col-3 col-md-3">
                                <input type="text" class="form-control" id="inputSegundoApellido"
                                    placeholder="Ingresa segundo apellido" name="SegundoApelldio">
                            </div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <label for="direccion" class="col-3 col-md-1 col-form-label h2">Dirección</label>
                            <div class="col-3 col-md-3">
                                <input type="text" class="form-control" id="inputDireccion"
                                    placeholder="Ingresa dirección" name="direccion">
                            </div>
                            <label for="InputRegion" class="col-3 col-md-1 col-form-label h2">Región</label>
                            <select class="form-select" id="InputRegion" name="inputRegion">
                            <option value="">Seleccione una Región</option>
                            </select>
                        </div>
                        <div class="form-group row justify-content-center">
                            <label for="InputComuna" class="col-3 col-md-1 col-form-label h2">Comuna</label>
                            <select class="form-select" id="InputComuna" name="comuna">
                            <option value="">Seleccione una Comuna</option>
                            </select>
                            <label for="fono" class="col-3 col-md-1 col-form-label h2">Fono</label>
                            <div class="col-3 col-md-3">
                                <input type="text" class="form-control" id="inputFono"
                                    placeholder="Ingresa fono" name="fono">
                            </div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <label for="correo" class="col-6 col-md-1 col-form-label h2">Correo</label>
                            <div class="col-6 col-md-6">
                                <input type="text" class="form-control" id="inputCorreo"
                                    placeholder="Ingresa correo" name="correo">
                            </div>
                        </div>

                        

                        <div id="carrito" class="form-group table-responsive" >
                            <table class="table" id="lista-compra" >
                                <thead>
                                    <tr>
                                        <th scope="col">Imagen</th>
                                        <th scope="col">Nombre</th>
                                        <th scope="col">Precio</th>
                                        <th scope="col">Cantidad</th>
                                        <th scope="col">Sub Total</th>
                                        <th scope="col">Eliminar</th>
                                    </tr>

                                </thead>
                                <tbody >

                                </tbody>
                                <tr>
                                    <th colspan="4" scope="col" class="text-right">SUB TOTAL :</th>
                                    <th scope="col">
                                        <p id="subtotal"></p>
                                    </th>
                                    <!-- <th scope="col"></th> -->
                                </tr>
                                <tr>
                                    <th colspan="4" scope="col" class="text-right">IVA :</th>
                                    <th scope="col">
                                        <p id="iva"></p>
                                    </th>
                                    <!-- <th scope="col"></th> -->
                                </tr>
                                <tr>
                                    <th colspan="4" scope="col" class="text-right">TOTAL :</th>
                                    <th scope="col">
                                        <input id="total" name="monto" class="font-weight-bold border-0" readonly style="background-color: white;"></input>
                                    </th>
                                    <!-- <th scope="col"></th> -->
                                </tr>

                            </table>
                        </div>

                        <div class="row justify-content-center" id="loaders">
                            <img id="cargando" src="imagenes/cargando.gif" width="220">
                        </div>

                        <div class="row justify-content-between">
                            <div class="col-md-4 mb-2">
                                <a href="index.html" class="btn btn-info btn-block">Seguir comprando</a>
                            </div>
                            <div class="col-xs-12 col-md-4">
                                <button href="boleta.html" class="btn btn-success btn-block" id="procesar-compra">Realizar compra</button>
                            </div>
                            
        
                        </div>
  


                       
                    </form>

                    

                </div>


            </div>

        </div>
    </main>
    <div class="text-center">
        <div>
            <a href="boleta.html" class="btn btn-success" id="botonBoleta">Boleta</a>
        </div>

    </div>
    
    

  <footer class="bg-light text-center text-white">
    <div class="text-center p-3" id="pie-compra">
      © 2022 Copyright:
      <a class="text-white" href="https://mdbootstrap.com/"></a>tujardin.com
  </footer>

    

  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/sweetalert2.min.js"></script>

 <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@2.3.2/dist/email.min.js"></script>

  <script src="js/carrito.js"></script>
  <script src="js/compra.js"></script>


  <script>

    const API_URL = 'http://127.0.0.1:5000';

    $(document).ready(function(){
      cargarRegiones();
      $('#botonBoleta').hide();
    });

 

    function cargarRegiones(){
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open("GET", `${API_URL}/static/assets/regiones`, true);
    xmlhttp.send();
    xmlhttp.onloadend = function(){
        var listado = xmlhttp.responseText;
        listado = listado.split('\n');
        listado.slice(1).forEach(function(region){
            var lista_regiones = region.split('|');
            $('#InputRegion').append('<option value="'+lista_regiones[0]+'">'+lista_regiones[1]+'</option>');
        });
    };
}

$('#InputRegion').change(function(event){
    var comuna = $(this).val();
    cargarComunas(comuna);
});

function cargarComunas(region_value) {
    $('#InputComuna').empty();
    if (region_value == '') {
        $('#InputComuna').append('<option value="">Seleccione una comuna</option>');
    };
    region_value = region_value;
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open("GET", `${API_URL}/static/assets/comunas`, true);
    xmlhttp.send();
    xmlhttp.onloadend = function() {
        var listado = xmlhttp.responseText;
        listado = listado.split('\n');
        listado.forEach(function(comuna) {
            var lista_comunas = comuna.split('|');
            if (parseInt(lista_comunas[2]) == region_value) {
                $('#InputComuna').append('<option value="'+lista_comunas[0]+'" name="'+lista_comunas[1]+'">'+lista_comunas[1]+'</option>');
            };
        });
    };
};



  </script>
  </body>
</html>